<!DOCTYPE html>
<html>
<head>
    <title>SPACE COLONY: THE HUSTLE</title>
    <style>
        body { margin: 0; overflow: hidden; background: #020205; font-family: 'Courier New', monospace; }
        #ui { position: absolute; top: 30px; left: 30px; color: #ff00ff; pointer-events: none; }
        #credits { font-size: 42px; text-shadow: 0 0 15px #ff00ff; color: #fff; }
        .stats { font-size: 14px; color: #00d4ff; margin-top: 5px; }
        #msg { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
               color: #00d4ff; font-size: 20px; opacity: 0; transition: 0.5s; pointer-events: none; }
    </style>
</head>
<body>

    <div id="ui">
        <div style="letter-spacing: 3px; font-size: 12px;">CRITICAL ASSETS</div>
        <div id="credits">ยง 0</div>
        <div id="orb-count" class="stats">ORBS COLLECTED: 0</div>
    </div>
    <div id="msg">+ยง100 BOUNTY</div>

    <script type="importmap">
        { "imports": { "three": "https://unpkg.com/three@0.160.0/build/three.module.js" } }
    </script>

    <script type="module">
        import * as THREE from 'three';

        const scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2(0x0a001a, 0.04);
        const camera = new THREE.PerspectiveCamera(65, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // --- THE COSMOS ---
        const starGeo = new THREE.BufferGeometry();
        const starPoints = [];
        for(let i=0; i<6000; i++) starPoints.push((Math.random()-0.5)*800, (Math.random()-0.5)*800, (Math.random()-0.5)*800);
        starGeo.setAttribute('position', new THREE.Float32BufferAttribute(starPoints, 3));
        scene.add(new THREE.Points(starGeo, new THREE.PointsMaterial({color: 0x00d4ff, size: 0.6})));

        // --- NEON PLANET ---
        const floor = new THREE.Mesh(new THREE.PlaneGeometry(1000, 1000), new THREE.MeshStandardMaterial({ color: 0x050505 }));
        floor.rotation.x = -Math.PI / 2;
        scene.add(floor);
        const grid = new THREE.GridHelper(200, 40, 0xff00ff, 0x101020);
        scene.add(grid);

        // --- ASTRONAUT ---
        const player = new THREE.Group();
        const suit = new THREE.Mesh(new THREE.CapsuleGeometry(0.4, 0.8), new THREE.MeshStandardMaterial({color: 0xffffff}));
        suit.position.y = 0.9;
        player.add(suit);
        const visor = new THREE.Mesh(new THREE.BoxGeometry(0.5, 0.2, 0.2), new THREE.MeshBasicMaterial({color: 0xff00ff}));
        visor.position.set(0, 1.3, 0.3);
        player.add(visor);
        scene.add(player);

        // --- GAMEPLAY ELEMENTS ---
        let score = 0;
        let orbsFound = 0;
        const orbs = [];
        function spawnOrb() {
            const orb = new THREE.Mesh(new THREE.IcosahedronGeometry(0.5, 1), new THREE.MeshBasicMaterial({color: 0x00d4ff, wireframe: true}));
            orb.position.set(Math.random()*100-50, 1, Math.random()*100-50);
            scene.add(orb);
            orbs.push(orb);
        }
        for(let i=0; i<15; i++) spawnOrb();

        // --- PHYSICS & LIGHT ---
        scene.add(new THREE.AmbientLight(0x202020));
        const pLight = new THREE.PointLight(0xff00ff, 50, 15);
        player.add(pLight);

        // --- CONTROLS ---
        const keys = {};
        let py = 0, vY = 0, isJumping = false;
        window.addEventListener('keydown', (e) => {
            keys[e.code] = true;
            if(e.code === 'Space' && !isJumping) { vY = 0.25; isJumping = true; }
        });
        window.addEventListener('keyup', (e) => keys[e.code] = false);

        function animate() {
            requestAnimationFrame(animate);
            
            // Movement
            if(keys['KeyW']) player.translateZ(0.2);
            if(keys['KeyS']) player.translateZ(-0.2);
            if(keys['KeyA']) player.rotation.y += 0.05;
            if(keys['KeyD']) player.rotation.y -= 0.05;

            // Gravity
            vY -= 0.01;
            py += vY;
            if(py <= 0) { py = 0; vY = 0; isJumping = false; }
            player.position.y = py;

            // Orb Collection
            orbs.forEach((orb, i) => {
                orb.rotation.y += 0.02;
                if(player.position.distanceTo(orb.position) < 1.5) {
                    scene.remove(orb);
                    orbs.splice(i, 1);
                    score += 100;
                    orbsFound++;
                    document.getElementById('credits').innerText = "ยง " + score;
                    document.getElementById('orb-count').innerText = "ORBS COLLECTED: " + orbsFound;
                    spawnOrb(); // Spawn new one
                    flashMsg();
                }
            });

            // Camera
            const camTarget = new THREE.Vector3(0, 5, -12).applyMatrix4(player.matrixWorld);
            camera.position.lerp(camTarget, 0.1);
            camera.lookAt(player.position);

            renderer.render(scene, camera);
        }

        function flashMsg() {
            const m = document.getElementById('msg');
            m.style.opacity = 1;
            setTimeout(() => m.style.opacity = 0, 1000);
        }
        
        animate();
    </script>
</body>
</html>
