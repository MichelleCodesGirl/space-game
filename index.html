<!DOCTYPE html>
<html>
<head>
    <title>SPACE TYCOON: REBOOT</title>
    <style>
        :root { --neon-blue: #00d4ff; --neon-pink: #ff00ff; }
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Segoe UI', sans-serif; }
        #ui { position: absolute; top: 20px; left: 20px; color: white; background: rgba(0,0,0,0.7); padding: 20px; border-radius: 10px; border: 1px solid var(--neon-blue); pointer-events: none; }
        #money { font-size: 32px; color: #00ff88; font-weight: bold; }
        .label { font-size: 12px; opacity: 0.7; letter-spacing: 1px; }
        #notif { position: absolute; top: 20px; right: 20px; color: var(--neon-pink); font-weight: bold; }
    </style>
</head>
<body>

    <div id="ui">
        <div class="label">COLONY BALANCE</div>
        <div id="money">§ 50</div>
        <div id="income" style="font-size: 14px; color: var(--neon-blue);">Passive Income: §0/sec</div>
    </div>
    <div id="notif"></div>

    <script type="importmap">
        { "imports": { "three": "https://unpkg.com/three@0.160.0/build/three.module.js" } }
    </script>

    <script type="module">
        import * as THREE from 'three';

        const scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2(0x020205, 0.03);
        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // --- THE VOID ---
        const starGeo = new THREE.BufferGeometry();
        const starArr = [];
        for(let i=0; i<8000; i++) starArr.push((Math.random()-0.5)*1000, (Math.random()-0.5)*1000, (Math.random()-0.5)*1000);
        starGeo.setAttribute('position', new THREE.Float32BufferAttribute(starArr, 3));
        scene.add(new THREE.Points(starGeo, new THREE.PointsMaterial({color: 0xffffff, size: 0.5})));

        const floor = new THREE.Mesh(new THREE.PlaneGeometry(1000, 1000), new THREE.MeshStandardMaterial({ color: 0x050505 }));
        floor.rotation.x = -Math.PI / 2;
        scene.add(floor);

        // --- TYCOON LOGIC ---
        let money = 50;
        let income = 0;
        const buyPads = [];

        function createBuyPad(x, z, cost, label, onPurchase) {
            const pad = new THREE.Group();
            const ring = new THREE.Mesh(new THREE.TorusGeometry(2, 0.1, 16, 32), new THREE.MeshBasicMaterial({color: 0x00d4ff}));
            ring.rotation.x = Math.PI/2;
            pad.add(ring);
            
            pad.position.set(x, 0.1, z);
            pad.userData = { cost, label, active: true, onPurchase };
            scene.add(pad);
            buyPads.push(pad);
        }

        // --- THE PLAYER ---
        const player = new THREE.Group();
        const body = new THREE.Mesh(new THREE.CapsuleGeometry(0.4, 0.8), new THREE.MeshStandardMaterial({color: 0xffffff}));
        body.position.y = 0.9;
        player.add(body);
        scene.add(player);
        scene.add(new THREE.AmbientLight(0x404040, 2));

        // --- STARTING UPGRADES ---
        createBuyPad(10, 0, 50, "Basic Miner", () => {
            income += 5;
            const miner = new THREE.Mesh(new THREE.BoxGeometry(2, 4, 2), new THREE.MeshStandardMaterial({color: 0x333333}));
            miner.position.set(10, 2, -5);
            scene.add(miner);
            createBuyPad(20, 0, 150, "Solar Array", () => {
                income += 20;
                const panel = new THREE.Mesh(new THREE.BoxGeometry(8, 0.5, 4), new THREE.MeshStandardMaterial({color: 0x00d4ff}));
                panel.position.set(20, 5, -5);
                scene.add(panel);
            });
        });

        // --- CONTROLS ---
        const keys = {};
        window.addEventListener('keydown', (e) => keys[e.code] = true);
        window.addEventListener('keyup', (e) => keys[e.code] = false);

        function animate() {
            requestAnimationFrame(animate);
            if(keys['KeyW']) player.translateZ(0.2);
            if(keys['KeyS']) player.translateZ(-0.2);
            if(keys['KeyA']) player.rotation.y += 0.05;
            if(keys['KeyD']) player.rotation.y -= 0.05;

            // Passive Income
            money += income / 60;
            document.getElementById('money').innerText = "§ " + Math.floor(money);
            document.getElementById('income').innerText = `Passive Income: §${income}/sec`;

            // Check Pads
            buyPads.forEach((pad, i) => {
                if(pad.userData.active && player.position.distanceTo(pad.position) < 2) {
                    if(money >= pad.userData.cost) {
                        money -= pad.userData.cost;
                        pad.userData.active = false;
                        scene.remove(pad);
                        pad.userData.onPurchase();
                        notify("PURCHASED: " + pad.userData.label);
                    } else {
                        notify("NEED §" + (pad.userData.cost - Math.floor(money)) + " MORE");
                    }
                }
            });

            const camPos = new THREE.Vector3(0, 6, -14).applyMatrix4(player.matrixWorld);
            camera.position.lerp(camPos, 0.1);
            camera.lookAt(player.position);
            renderer.render(scene, camera);
        }

        function notify(text) {
            const n = document.getElementById('notif');
            n.innerText = text;
            setTimeout(() => { if(n.innerText === text) n.innerText = ""; }, 2000);
        }

        animate();
    </script>
</body>
</html>
